µ
SC:\Users\pspgo\Desktop\SistemaPrestamo\SistemaPrestamo\Prestamo.Data\UsuarioData.cs
	namespace 	
Prestamo
 
. 
Data 
{ 
public 

class 
UsuarioData 
{ 
private 
readonly 
ConnectionStrings *
con+ .
;. /
public 
UsuarioData 
( 
IOptions #
<# $
ConnectionStrings$ 5
>5 6
options7 >
)> ?
{ 	
con 
= 
options 
. 
Value 
;  
} 	
public 
async 
Task 
< 
Usuario !
>! "
Obtener# *
(* +
string+ 1
correo2 8
,8 9
string9 ?
clave@ E
)E F
{ 	
Usuario 
objeto 
= 
null !
!! "
;" #
using 
( 
var 
conexion 
=  !
new" %
SqlConnection& 3
(3 4
con4 7
.7 8
	CadenaSQL8 A
)A B
)B C
{ 
await 
conexion 
. 
	OpenAsync (
(( )
)) *
;* +

SqlCommand 
cmd 
=  
new! $

SqlCommand% /
(/ 0
$str0 C
,C D
conexionE M
)M N
;N O
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 5
,5 6
correo7 =
)= >
;> ?
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 4
,4 5
clave6 ;
); <
;< =
cmd 
. 
CommandType 
=  !
CommandType" -
.- .
StoredProcedure. =
;= >
using!! 
(!! 
var!! 
dr!! 
=!! 
await!!  %
cmd!!& )
.!!) *
ExecuteReaderAsync!!* <
(!!< =
)!!= >
)!!> ?
{"" 
while## 
(## 
await##  
dr##! #
.### $
	ReadAsync##$ -
(##- .
)##. /
)##/ 0
{$$ 
objeto%% 
=%%  
new%%! $
Usuario%%% ,
(%%, -
)%%- .
{&& 
	IdUsuario'' %
=''& '
Convert''( /
.''/ 0
ToInt32''0 7
(''7 8
dr''8 :
['': ;
$str''; F
]''F G
.''G H
ToString''H P
(''P Q
)''Q R
!''R S
)''S T
,''T U
NombreCompleto(( *
=((+ ,
dr((- /
[((/ 0
$str((0 @
]((@ A
.((A B
ToString((B J
(((J K
)((K L
!((L M
,((M N
Correo)) "
=))# $
dr))% '
[))' (
$str))( 0
]))0 1
.))1 2
ToString))2 :
()): ;
))); <
!))< =
}** 
;** 
}++ 
},, 
}-- 
return.. 
objeto.. 
;.. 
}// 	
}00 
}11 ë
SC:\Users\pspgo\Desktop\SistemaPrestamo\SistemaPrestamo\Prestamo.Data\ResumenData.cs
	namespace 	
Prestamo
 
. 
Data 
{ 
public 

class 
ResumenData 
{ 
private		 
readonly		 
ConnectionStrings		 *
con		+ .
;		. /
public

 
ResumenData

 
(

 
IOptions

 #
<

# $
ConnectionStrings

$ 5
>

5 6
options

7 >
)

> ?
{ 	
con 
= 
options 
. 
Value 
;  
} 	
public 
async 
Task 
< 
Resumen !
>! "
Obtener# *
(* +
)+ ,
{ 	
Resumen 
objeto 
= 
new  
Resumen! (
(( )
)) *
;* +
using 
( 
var 
conexion 
=  !
new" %
SqlConnection& 3
(3 4
con4 7
.7 8
	CadenaSQL8 A
)A B
)B C
{ 
await 
conexion 
. 
	OpenAsync (
(( )
)) *
;* +

SqlCommand 
cmd 
=  
new! $

SqlCommand% /
(/ 0
$str0 C
,C D
conexionE M
)M N
;N O
cmd 
. 
CommandType 
=  !
CommandType" -
.- .
StoredProcedure. =
;= >
using 
( 
var 
dr 
= 
await  %
cmd& )
.) *
ExecuteReaderAsync* <
(< =
)= >
)> ?
{ 
while 
( 
await  
dr! #
.# $
	ReadAsync$ -
(- .
). /
)/ 0
{ 
objeto 
=  
new! $
Resumen% ,
(, -
)- .
{ 
TotalClientes )
=* +
dr, .
[. /
$str/ >
]> ?
.? @
ToString@ H
(H I
)I J
!J K
,K L
PrestamosPendientes   /
=  0 1
dr  2 4
[  4 5
$str  5 J
]  J K
.  K L
ToString  L T
(  T U
)  U V
!  V W
,  W X
PrestamosCancelados!! /
=!!0 1
dr!!2 4
[!!4 5
$str!!5 J
]!!J K
.!!K L
ToString!!L T
(!!T U
)!!U V
!!!V W
,!!W X
InteresAcumulado"" ,
=""- .
dr""/ 1
[""1 2
$str""2 D
]""D E
.""E F
ToString""F N
(""N O
)""O P
!""P Q
,""Q R
}## 
;## 
}$$ 
}%% 
}&& 
return'' 
objeto'' 
;'' 
}(( 	
}++ 
},, ¥ü
TC:\Users\pspgo\Desktop\SistemaPrestamo\SistemaPrestamo\Prestamo.Data\PrestamoData.cs
	namespace		 	
Prestamo		
 
.		 
Data		 
{

 
public 

class 
PrestamoData 
{ 
private 
readonly 
ConnectionStrings *
con+ .
;. /
public 
PrestamoData 
( 
IOptions $
<$ %
ConnectionStrings% 6
>6 7
options8 ?
)? @
{ 	
con 
= 
options 
. 
Value 
;  
} 	
public 
async 
Task 
< 
string  
>  !
Crear" '
(' (
Prestamo( 0
.0 1
	Entidades1 :
.: ;
Prestamo; C
objetoD J
)J K
{ 	
string 
	respuesta 
= 
$str !
;! "
using 
( 
var 
conexion 
=  !
new" %
SqlConnection& 3
(3 4
con4 7
.7 8
	CadenaSQL8 A
)A B
)B C
{ 
await 
conexion 
. 
	OpenAsync (
(( )
)) *
;* +

SqlCommand 
cmd 
=  
new! $

SqlCommand% /
(/ 0
$str0 B
,B C
conexionD L
)L M
;M N
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 8
,8 9
objeto: @
.@ A
ClienteA H
.H I
	IdClienteI R
)R S
;S T
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, ;
,; <
objeto= C
.C D
ClienteD K
.K L
NroDocumentoL X
)X Y
;Y Z
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 5
,5 6
objeto7 =
.= >
Cliente> E
.E F
NombreF L
)L M
;M N
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 7
,7 8
objeto9 ?
.? @
Cliente@ G
.G H
ApellidoH P
)P Q
;Q R
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, 5
,5 6
objeto7 =
.= >
Cliente> E
.E F
CorreoF L
)L M
;M N
cmd   
.   

Parameters   
.   
AddWithValue   +
(  + ,
$str  , 7
,  7 8
objeto  9 ?
.  ? @
Cliente  @ G
.  G H
Telefono  H P
)  P Q
;  Q R
cmd!! 
.!! 

Parameters!! 
.!! 
AddWithValue!! +
(!!+ ,
$str!!, 7
,!!7 8
objeto!!9 ?
.!!? @
Moneda!!@ F
.!!F G
IdMoneda!!G O
)!!O P
;!!P Q
cmd"" 
."" 

Parameters"" 
."" 
AddWithValue"" +
(""+ ,
$str"", :
,"": ;
objeto""< B
.""B C
FechaInicioPago""C R
)""R S
;""S T
cmd## 
.## 

Parameters## 
.## 
AddWithValue## +
(##+ ,
$str##, <
,##< =
objeto##> D
.##D E
MontoPrestamo##E R
)##R S
;##S T
cmd$$ 
.$$ 

Parameters$$ 
.$$ 
AddWithValue$$ +
($$+ ,
$str$$, @
,$$@ A
objeto$$B H
.$$H I
InteresPorcentaje$$I Z
)$$Z [
;$$[ \
cmd%% 
.%% 

Parameters%% 
.%% 
AddWithValue%% +
(%%+ ,
$str%%, 8
,%%8 9
objeto%%: @
.%%@ A
	NroCuotas%%A J
)%%J K
;%%K L
cmd&& 
.&& 

Parameters&& 
.&& 
AddWithValue&& +
(&&+ ,
$str&&, :
,&&: ;
objeto&&< B
.&&B C
FormaDePago&&C N
)&&N O
;&&O P
cmd'' 
.'' 

Parameters'' 
.'' 
AddWithValue'' +
(''+ ,
$str'', <
,''< =
objeto''> D
.''D E
ValorPorCuota''E R
)''R S
;''S T
cmd(( 
.(( 

Parameters(( 
.(( 
AddWithValue(( +
(((+ ,
$str((, ;
,((; <
objeto((= C
.((C D
ValorInteres((D P
)((P Q
;((Q R
cmd)) 
.)) 

Parameters)) 
.)) 
AddWithValue)) +
())+ ,
$str)), 9
,))9 :
objeto)); A
.))A B

ValorTotal))B L
)))L M
;))M N
cmd** 
.** 

Parameters** 
.** 
Add** "
(**" #
$str**# .
,**. /
	SqlDbType**0 9
.**9 :
VarChar**: A
,**A B
$num**C F
)**F G
.**G H
	Direction**H Q
=**R S
ParameterDirection**T f
.**f g
Output**g m
;**m n
cmd++ 
.++ 
CommandType++ 
=++  !
CommandType++" -
.++- .
StoredProcedure++. =
;++= >
try-- 
{.. 
await// 
cmd// 
.//  
ExecuteNonQueryAsync// 2
(//2 3
)//3 4
;//4 5
	respuesta00 
=00 
Convert00  '
.00' (
ToString00( 0
(000 1
cmd001 4
.004 5

Parameters005 ?
[00? @
$str00@ K
]00K L
.00L M
Value00M R
)00R S
!00S T
;00T U
}11 
catch22 
{33 
	respuesta44 
=44 
$str44  3
;443 4
}55 
}66 
return77 
	respuesta77 
;77 
}88 	
public:: 
async:: 
Task:: 
<:: 
List:: 
<:: 
Prestamo:: '
.::' (
	Entidades::( 1
.::1 2
Prestamo::2 :
>::: ;
>::; <
ObtenerPrestamos::= M
(::M N
int::N Q
Id::R T
,::T U
string::V \
NroDocumento::] i
)::i j
{;; 	
List<< 
<<< 
Prestamo<< 
.<< 
	Entidades<< #
.<<# $
Prestamo<<$ ,
><<, -
lista<<. 3
=<<4 5
new<<6 9
List<<: >
<<<> ?
Prestamo<<? G
.<<G H
	Entidades<<H Q
.<<Q R
Prestamo<<R Z
><<Z [
(<<[ \
)<<\ ]
;<<] ^
using>> 
(>> 
var>> 
conexion>> 
=>>  !
new>>" %
SqlConnection>>& 3
(>>3 4
con>>4 7
.>>7 8
	CadenaSQL>>8 A
)>>A B
)>>B C
{?? 
await@@ 
conexion@@ 
.@@ 
	OpenAsync@@ (
(@@( )
)@@) *
;@@* +

SqlCommandAA 
cmdAA 
=AA  
newAA! $

SqlCommandAA% /
(AA/ 0
$strAA0 E
,AAE F
conexionAAG O
)AAO P
;AAP Q
cmdBB 
.BB 

ParametersBB 
.BB 
AddWithValueBB +
(BB+ ,
$strBB, 9
,BB9 :
IdBB; =
)BB= >
;BB> ?
cmdCC 
.CC 

ParametersCC 
.CC 
AddWithValueCC +
(CC+ ,
$strCC, ;
,CC; <
NroDocumentoCC= I
)CCI J
;CCJ K
cmdDD 
.DD 
CommandTypeDD 
=DD  !
CommandTypeDD" -
.DD- .
StoredProcedureDD. =
;DD= >
usingFF 
(FF 
varFF 
drFF 
=FF 
awaitFF  %
cmdFF& )
.FF) *!
ExecuteXmlReaderAsyncFF* ?
(FF? @
)FF@ A
)FFA B
{GG 
ifHH 
(HH 
awaitHH 
drHH  
.HH  !
	ReadAsyncHH! *
(HH* +
)HH+ ,
)HH, -
{II 
	XDocumentJJ !
docJJ" %
=JJ& '
	XDocumentJJ( 1
.JJ1 2
LoadJJ2 6
(JJ6 7
drJJ7 9
)JJ9 :
;JJ: ;
listaKK 
=KK 
(KK  !
(KK! "
docKK" %
.KK% &
ElementsKK& .
(KK. /
$strKK/ :
)KK: ;
)KK; <
!=KK= ?
nullKK@ D
)KKD E
?KKF G
(KKH I
fromKKI M
prestamoKKN V
inKKW Y
docKKZ ]
.KK] ^
ElementKK^ e
(KKe f
$strKKf q
)KKq r
!KKr s
.KKs t
ElementsKKt |
(KK| }
$str	KK} á
)
KKá à
selectLLM S
newLLT W
PrestamoLLX `
.LL` a
	EntidadesLLa j
.LLj k
PrestamoLLk s
(LLs t
)LLt u
{MMM N

IdPrestamoNNQ [
=NN\ ]
ConvertNN^ e
.NNe f
ToInt32NNf m
(NNm n
prestamoNNn v
.NNv w
ElementNNw ~
(NN~ 
$str	NN ã
)
NNã å
!
NNå ç
.
NNç é
Value
NNé ì
)
NNì î
,
NNî ï
ClienteOOQ X
=OOY Z
newOO[ ^
ClienteOO_ f
(OOf g
)OOg h
{PPQ R
	IdClienteQQU ^
=QQ_ `
ConvertQQa h
.QQh i
ToInt32QQi p
(QQp q
prestamoQQq y
.QQy z
Element	QQz Å
(
QQÅ Ç
$str
QQÇ ç
)
QQç é
!
QQé è
.
QQè ê
Value
QQê ï
)
QQï ñ
,
QQñ ó
NroDocumentoRRU a
=RRb c
prestamoRRd l
.RRl m
ElementRRm t
(RRt u
$str	RRu É
)
RRÉ Ñ
!
RRÑ Ö
.
RRÖ Ü
Value
RRÜ ã
,
RRã å
NombreSSU [
=SS\ ]
prestamoSS^ f
.SSf g
ElementSSg n
(SSn o
$strSSo w
)SSw x
!SSx y
.SSy z
ValueSSz 
,	SS Ä
ApellidoTTU ]
=TT^ _
prestamoTT` h
.TTh i
ElementTTi p
(TTp q
$strTTq {
)TT{ |
!TT| }
.TT} ~
Value	TT~ É
,
TTÉ Ñ
CorreoUUU [
=UU\ ]
prestamoUU^ f
.UUf g
ElementUUg n
(UUn o
$strUUo w
)UUw x
!UUx y
.UUy z
ValueUUz 
,	UU Ä
TelefonoVVU ]
=VV^ _
prestamoVV` h
.VVh i
ElementVVi p
(VVp q
$strVVq {
)VV{ |
!VV| }
.VV} ~
Value	VV~ É
}WWQ R
,WWR S
MonedaXXQ W
=XXX Y
newXXZ ]
MonedaXX^ d
{YYQ R
IdMonedaZZU ]
=ZZ^ _
ConvertZZ` g
.ZZg h
ToInt32ZZh o
(ZZo p
prestamoZZp x
.ZZx y
Element	ZZy Ä
(
ZZÄ Å
$str
ZZÅ ã
)
ZZã å
!
ZZå ç
.
ZZç é
Value
ZZé ì
)
ZZì î
,
ZZî ï
Nombre[[U [
=[[\ ]
prestamo[[^ f
.[[f g
Element[[g n
([[n o
$str[[o }
)[[} ~
![[~ 
.	[[ Ä
Value
[[Ä Ö
,
[[Ö Ü
Simbolo\\U \
=\\] ^
prestamo\\_ g
.\\g h
Element\\h o
(\\o p
$str\\p y
)\\y z
!\\z {
.\\{ |
Value	\\| Å
}]]Q R
,]]R S
FechaInicioPago^^Q `
=^^a b
prestamo^^c k
.^^k l
Element^^l s
(^^s t
$str	^^t Ö
)
^^Ö Ü
!
^^Ü á
.
^^á à
Value
^^à ç
,
^^ç é
MontoPrestamo__Q ^
=___ `
prestamo__a i
.__i j
Element__j q
(__q r
$str	__r Å
)
__Å Ç
!
__Ç É
.
__É Ñ
Value
__Ñ â
,
__â ä
InteresPorcentaje``Q b
=``c d
prestamo``e m
.``m n
Element``n u
(``u v
$str	``v â
)
``â ä
!
``ä ã
.
``ã å
Value
``å ë
,
``ë í
	NroCuotasaaQ Z
=aa[ \
Convertaa] d
.aad e
ToInt32aae l
(aal m
prestamoaam u
.aau v
Elementaav }
(aa} ~
$str	aa~ â
)
aaâ ä
!
aaä ã
.
aaã å
Value
aaå ë
)
aaë í
,
aaí ì
FormaDePagobbQ \
=bb] ^
prestamobb_ g
.bbg h
Elementbbh o
(bbo p
$strbbp }
)bb} ~
!bb~ 
.	bb Ä
Value
bbÄ Ö
,
bbÖ Ü
ValorPorCuotaccQ ^
=cc_ `
prestamocca i
.cci j
Elementccj q
(ccq r
$str	ccr Å
)
ccÅ Ç
!
ccÇ É
.
ccÉ Ñ
Value
ccÑ â
,
ccâ ä
ValorInteresddQ ]
=dd^ _
prestamodd` h
.ddh i
Elementddi p
(ddp q
$strddq 
)	dd Ä
!
ddÄ Å
.
ddÅ Ç
Value
ddÇ á
,
ddá à

ValorTotaleeQ [
=ee\ ]
prestamoee^ f
.eef g
Elementeeg n
(een o
$streeo {
)ee{ |
!ee| }
.ee} ~
Value	ee~ É
,
eeÉ Ñ
EstadoffQ W
=ffX Y
prestamoffZ b
.ffb c
Elementffc j
(ffj k
$strffk s
)ffs t
!fft u
.ffu v
Valueffv {
,ff{ |
FechaCreacionggQ ^
=gg_ `
prestamogga i
.ggi j
Elementggj q
(ggq r
$str	ggr Å
)
ggÅ Ç
!
ggÇ É
.
ggÉ Ñ
Value
ggÑ â
,
ggâ ä
PrestamoDetallehhQ `
=hha b
prestamohhc k
.hhk l
Elementshhl t
(hht u
$str	hhu Ü
)
hhÜ á
!=
hhà ä
null
hhã è
?
hhê ë
(
hhí ì
from
hhì ó
detalle
hhò ü
in
hh† ¢
prestamo
hh£ ´
.
hh´ ¨
Element
hh¨ ≥
(
hh≥ ¥
$str
hh¥ ≈
)
hh≈ ∆
!
hh∆ «
.
hh« »
Elements
hh» –
(
hh– —
$str
hh— ⁄
)
hh⁄ €
select
iiå í
new
iiì ñ
PrestamoDetalle
iió ¶
(
ii¶ ß
)
iiß ®
{
jjå ç
IdPrestamoDetalle
kkê °
=
kk¢ £
Convert
kk§ ´
.
kk´ ¨
ToInt32
kk¨ ≥
(
kk≥ ¥
detalle
kk¥ ª
.
kkª º
Element
kkº √
(
kk√ ƒ
$str
kkƒ ◊
)
kk◊ ÿ
!
kkÿ Ÿ
.
kkŸ ⁄
Value
kk⁄ ﬂ
)
kkﬂ ‡
,
kk‡ ·
	FechaPago
llê ô
=
llö õ
detalle
llú £
.
ll£ §
Element
ll§ ´
(
ll´ ¨
$str
ll¨ ∑
)
ll∑ ∏
!
ll∏ π
.
llπ ∫
Value
ll∫ ø
,
llø ¿

MontoCuota
mmê ö
=
mmõ ú
detalle
mmù §
.
mm§ •
Element
mm• ¨
(
mm¨ ≠
$str
mm≠ π
)
mmπ ∫
!
mm∫ ª
.
mmª º
Value
mmº ¡
,
mm¡ ¬
NroCuota
nnê ò
=
nnô ö
Convert
nnõ ¢
.
nn¢ £
ToInt32
nn£ ™
(
nn™ ´
detalle
nn´ ≤
.
nn≤ ≥
Element
nn≥ ∫
(
nn∫ ª
$str
nnª ≈
)
nn≈ ∆
!
nn∆ «
.
nn« »
Value
nn» Õ
)
nnÕ Œ
,
nnŒ œ
Estado
ooê ñ
=
ooó ò
detalle
ooô †
.
oo† °
Element
oo° ®
(
oo® ©
$str
oo© ±
)
oo± ≤
!
oo≤ ≥
.
oo≥ ¥
Value
oo¥ π
,
ooπ ∫
FechaPagado
ppê õ
=
ppú ù
detalle
ppû •
.
pp• ¶
Element
pp¶ ≠
(
pp≠ Æ
$str
ppÆ ª
)
ppª º
!
ppº Ω
.
ppΩ æ
Value
ppæ √
}
qqå ç
)
qqç é
.
qqé è
ToList
qqè ï
(
qqï ñ
)
qqñ ó
:
qqò ô
new
qqö ù
List
qqû ¢
<
qq¢ £
PrestamoDetalle
qq£ ≤
>
qq≤ ≥
(
qq≥ ¥
)
qq¥ µ
}ssM N
)ssN O
.ssO P
ToListssP V
(ssV W
)ssW X
:ssY Z
newss[ ^
Listss_ c
<ssc d
Prestamossd l
.ssl m
	Entidadesssm v
.ssv w
Prestamossw 
>	ss Ä
(
ssÄ Å
)
ssÅ Ç
;
ssÇ É
}uu 
}vv 
}ww 
returnxx 
listaxx 
;xx 
}yy 	
public{{ 
async{{ 
Task{{ 
<{{ 
string{{  
>{{  !
PagarCuotas{{" -
({{- .
int{{. 1

IdPrestamo{{2 <
,{{< =
string{{> D
NroCuotasPagadas{{E U
){{U V
{|| 	
string~~ 
	respuesta~~ 
=~~ 
$str~~ !
;~~! "
using 
( 
var 
conexion 
=  !
new" %
SqlConnection& 3
(3 4
con4 7
.7 8
	CadenaSQL8 A
)A B
)B C
{
ÄÄ 
await
ÅÅ 
conexion
ÅÅ 
.
ÅÅ 
	OpenAsync
ÅÅ (
(
ÅÅ( )
)
ÅÅ) *
;
ÅÅ* +

SqlCommand
ÇÇ 
cmd
ÇÇ 
=
ÇÇ  
new
ÇÇ! $

SqlCommand
ÇÇ% /
(
ÇÇ/ 0
$str
ÇÇ0 @
,
ÇÇ@ A
conexion
ÇÇB J
)
ÇÇJ K
;
ÇÇK L
cmd
ÉÉ 
.
ÉÉ 

Parameters
ÉÉ 
.
ÉÉ 
AddWithValue
ÉÉ +
(
ÉÉ+ ,
$str
ÉÉ, 9
,
ÉÉ9 :

IdPrestamo
ÉÉ; E
)
ÉÉE F
;
ÉÉF G
cmd
ÑÑ 
.
ÑÑ 

Parameters
ÑÑ 
.
ÑÑ 
AddWithValue
ÑÑ +
(
ÑÑ+ ,
$str
ÑÑ, ?
,
ÑÑ? @
NroCuotasPagadas
ÑÑA Q
)
ÑÑQ R
;
ÑÑR S
cmd
ÖÖ 
.
ÖÖ 

Parameters
ÖÖ 
.
ÖÖ 
Add
ÖÖ "
(
ÖÖ" #
$str
ÖÖ# .
,
ÖÖ. /
	SqlDbType
ÖÖ0 9
.
ÖÖ9 :
VarChar
ÖÖ: A
,
ÖÖA B
$num
ÖÖC F
)
ÖÖF G
.
ÖÖG H
	Direction
ÖÖH Q
=
ÖÖR S 
ParameterDirection
ÖÖT f
.
ÖÖf g
Output
ÖÖg m
;
ÖÖm n
cmd
ÜÜ 
.
ÜÜ 
CommandType
ÜÜ 
=
ÜÜ  !
CommandType
ÜÜ" -
.
ÜÜ- .
StoredProcedure
ÜÜ. =
;
ÜÜ= >
try
àà 
{
ââ 
await
ää 
cmd
ää 
.
ää "
ExecuteNonQueryAsync
ää 2
(
ää2 3
)
ää3 4
;
ää4 5
	respuesta
ãã 
=
ãã 
Convert
ãã  '
.
ãã' (
ToString
ãã( 0
(
ãã0 1
cmd
ãã1 4
.
ãã4 5

Parameters
ãã5 ?
[
ãã? @
$str
ãã@ K
]
ããK L
.
ããL M
Value
ããM R
)
ããR S
!
ããS T
;
ããT U
}
åå 
catch
çç 
{
éé 
	respuesta
èè 
=
èè 
$str
èè  3
;
èè3 4
}
êê 
}
ëë 
return
íí 
	respuesta
íí 
;
íí 
}
ìì 	
}
ïï 
}ññ ¿U
RC:\Users\pspgo\Desktop\SistemaPrestamo\SistemaPrestamo\Prestamo.Data\MonedaData.cs
	namespace 	
Prestamo
 
. 
Data 
{ 
public 

class 

MonedaData 
{		 
private

 
readonly

 
ConnectionStrings

 *
con

+ .
;

. /
public 

MonedaData 
( 
IOptions "
<" #
ConnectionStrings# 4
>4 5
options6 =
)= >
{ 	
con 
= 
options 
. 
Value 
;  
} 	
public 
async 
Task 
< 
List 
< 
Moneda %
>% &
>& '
Lista( -
(- .
). /
{ 	
List 
< 
Moneda 
> 
lista 
=  
new! $
List% )
<) *
Moneda* 0
>0 1
(1 2
)2 3
;3 4
using 
( 
var 
conexion 
=  !
new" %
SqlConnection& 3
(3 4
con4 7
.7 8
	CadenaSQL8 A
)A B
)B C
{ 
await 
conexion 
. 
	OpenAsync (
(( )
)) *
;* +

SqlCommand 
cmd 
=  
new! $

SqlCommand% /
(/ 0
$str0 @
,@ A
conexionB J
)J K
;K L
cmd 
. 
CommandType 
=  !
CommandType" -
.- .
StoredProcedure. =
;= >
using 
( 
var 
dr 
= 
await  %
cmd& )
.) *
ExecuteReaderAsync* <
(< =
)= >
)> ?
{ 
while 
( 
await  
dr! #
.# $
	ReadAsync$ -
(- .
). /
)/ 0
{ 
lista 
. 
Add !
(! "
new" %
Moneda& ,
(, -
)- .
{ 
IdMoneda   $
=  % &
Convert  ' .
.  . /
ToInt32  / 6
(  6 7
dr  7 9
[  9 :
$str  : D
]  D E
)  E F
,  F G
Nombre!! "
=!!# $
dr!!% '
[!!' (
$str!!( 0
]!!0 1
.!!1 2
ToString!!2 :
(!!: ;
)!!; <
!!!< =
,!!= >
Simbolo"" #
=""$ %
dr""& (
[""( )
$str"") 2
]""2 3
.""3 4
ToString""4 <
(""< =
)""= >
!""> ?
,""? @
FechaCreacion## )
=##* +
dr##, .
[##. /
$str##/ >
]##> ?
.##? @
ToString##@ H
(##H I
)##I J
!##J K
}$$ 
)$$ 
;$$ 
}%% 
}&& 
}'' 
return(( 
lista(( 
;(( 
})) 	
public++ 
async++ 
Task++ 
<++ 
string++  
>++  !
Crear++" '
(++' (
Moneda++( .
objeto++/ 5
)++5 6
{,, 	
string.. 
	respuesta.. 
=.. 
$str.. !
;..! "
using// 
(// 
var// 
conexion// 
=//  !
new//" %
SqlConnection//& 3
(//3 4
con//4 7
.//7 8
	CadenaSQL//8 A
)//A B
)//B C
{00 
await11 
conexion11 
.11 
	OpenAsync11 (
(11( )
)11) *
;11* +

SqlCommand22 
cmd22 
=22  
new22! $

SqlCommand22% /
(22/ 0
$str220 @
,22@ A
conexion22B J
)22J K
;22K L
cmd33 
.33 

Parameters33 
.33 
AddWithValue33 +
(33+ ,
$str33, 5
,335 6
objeto337 =
.33= >
Nombre33> D
)33D E
;33E F
cmd44 
.44 

Parameters44 
.44 
AddWithValue44 +
(44+ ,
$str44, 6
,446 7
objeto448 >
.44> ?
Simbolo44? F
)44F G
;44G H
cmd55 
.55 

Parameters55 
.55 
Add55 "
(55" #
$str55# .
,55. /
	SqlDbType550 9
.559 :
VarChar55: A
,55A B
$num55C F
)55F G
.55G H
	Direction55H Q
=55R S
ParameterDirection55T f
.55f g
Output55g m
;55m n
cmd66 
.66 
CommandType66 
=66  !
CommandType66" -
.66- .
StoredProcedure66. =
;66= >
try88 
{99 
await:: 
cmd:: 
.::  
ExecuteNonQueryAsync:: 2
(::2 3
)::3 4
;::4 5
	respuesta;; 
=;; 
Convert;;  '
.;;' (
ToString;;( 0
(;;0 1
cmd;;1 4
.;;4 5

Parameters;;5 ?
[;;? @
$str;;@ K
];;K L
.;;L M
Value;;M R
);;R S
!;;S T
;;;T U
}<< 
catch== 
{>> 
	respuesta?? 
=?? 
$str??  3
;??3 4
}@@ 
}AA 
returnBB 
	respuestaBB 
;BB 
}CC 	
publicEE 
asyncEE 
TaskEE 
<EE 
stringEE  
>EE  !
EditarEE" (
(EE( )
MonedaEE) /
objetoEE0 6
)EE6 7
{FF 	
stringHH 
	respuestaHH 
=HH 
$strHH !
;HH! "
usingII 
(II 
varII 
conexionII 
=II  !
newII" %
SqlConnectionII& 3
(II3 4
conII4 7
.II7 8
	CadenaSQLII8 A
)IIA B
)IIB C
{JJ 
awaitKK 
conexionKK 
.KK 
	OpenAsyncKK (
(KK( )
)KK) *
;KK* +

SqlCommandLL 
cmdLL 
=LL  
newLL! $

SqlCommandLL% /
(LL/ 0
$strLL0 A
,LLA B
conexionLLC K
)LLK L
;LLL M
cmdMM 
.MM 

ParametersMM 
.MM 
AddWithValueMM +
(MM+ ,
$strMM, 7
,MM7 8
objetoMM9 ?
.MM? @
IdMonedaMM@ H
)MMH I
;MMI J
cmdNN 
.NN 

ParametersNN 
.NN 
AddWithValueNN +
(NN+ ,
$strNN, 5
,NN5 6
objetoNN7 =
.NN= >
NombreNN> D
)NND E
;NNE F
cmdOO 
.OO 

ParametersOO 
.OO 
AddWithValueOO +
(OO+ ,
$strOO, 6
,OO6 7
objetoOO8 >
.OO> ?
SimboloOO? F
)OOF G
;OOG H
cmdPP 
.PP 

ParametersPP 
.PP 
AddPP "
(PP" #
$strPP# .
,PP. /
	SqlDbTypePP0 9
.PP9 :
VarCharPP: A
,PPA B
$numPPC F
)PPF G
.PPG H
	DirectionPPH Q
=PPR S
ParameterDirectionPPT f
.PPf g
OutputPPg m
;PPm n
cmdQQ 
.QQ 
CommandTypeQQ 
=QQ  !
CommandTypeQQ" -
.QQ- .
StoredProcedureQQ. =
;QQ= >
trySS 
{TT 
awaitUU 
cmdUU 
.UU  
ExecuteNonQueryAsyncUU 2
(UU2 3
)UU3 4
;UU4 5
	respuestaVV 
=VV 
ConvertVV  '
.VV' (
ToStringVV( 0
(VV0 1
cmdVV1 4
.VV4 5

ParametersVV5 ?
[VV? @
$strVV@ K
]VVK L
.VVL M
ValueVVM R
)VVR S
!VVS T
;VVT U
}WW 
catchXX 
{YY 
	respuestaZZ 
=ZZ 
$strZZ  3
;ZZ3 4
}[[ 
}\\ 
return]] 
	respuesta]] 
;]] 
}^^ 	
public`` 
async`` 
Task`` 
<`` 
string``  
>``  !
Eliminar``" *
(``* +
int``+ .
Id``/ 1
)``1 2
{aa 	
stringcc 
	respuestacc 
=cc 
$strcc !
;cc! "
usingdd 
(dd 
vardd 
conexiondd 
=dd  !
newdd" %
SqlConnectiondd& 3
(dd3 4
condd4 7
.dd7 8
	CadenaSQLdd8 A
)ddA B
)ddB C
{ee 
awaitff 
conexionff 
.ff 
	OpenAsyncff (
(ff( )
)ff) *
;ff* +

SqlCommandgg 
cmdgg 
=gg  
newgg! $

SqlCommandgg% /
(gg/ 0
$strgg0 C
,ggC D
conexionggE M
)ggM N
;ggN O
cmdhh 
.hh 

Parametershh 
.hh 
AddWithValuehh +
(hh+ ,
$strhh, 7
,hh7 8
Idhh9 ;
)hh; <
;hh< =
cmdii 
.ii 

Parametersii 
.ii 
Addii "
(ii" #
$strii# .
,ii. /
	SqlDbTypeii0 9
.ii9 :
VarCharii: A
,iiA B
$numiiC F
)iiF G
.iiG H
	DirectioniiH Q
=iiR S
ParameterDirectioniiT f
.iif g
Outputiig m
;iim n
cmdjj 
.jj 
CommandTypejj 
=jj  !
CommandTypejj" -
.jj- .
StoredProcedurejj. =
;jj= >
tryll 
{mm 
awaitnn 
cmdnn 
.nn  
ExecuteNonQueryAsyncnn 2
(nn2 3
)nn3 4
;nn4 5
	respuestaoo 
=oo 
Convertoo  '
.oo' (
ToStringoo( 0
(oo0 1
cmdoo1 4
.oo4 5

Parametersoo5 ?
[oo? @
$stroo@ K
]ooK L
.ooL M
ValueooM R
)ooR S
!ooS T
;ooT U
}pp 
catchqq 
{rr 
	respuestass 
=ss 
$strss  3
;ss3 4
}tt 
}uu 
returnvv 
	respuestavv 
;vv 
}ww 	
}xx 
}yy Å
YC:\Users\pspgo\Desktop\SistemaPrestamo\SistemaPrestamo\Prestamo.Data\ConnectionStrings.cs
	namespace 	
Prestamo
 
. 
Data 
{ 
public		 

class		 
ConnectionStrings		 "
{

 
public 
string 
	CadenaSQL 
{  !
get" %
;% &
set' *
;* +
}, -
=. /
null0 4
!4 5
;5 6
} 
} ©Å
SC:\Users\pspgo\Desktop\SistemaPrestamo\SistemaPrestamo\Prestamo.Data\ClienteData.cs
	namespace 	
Prestamo
 
. 
Data 
{ 
public 

class 
ClienteData 
{		 
private

 
readonly

 
ConnectionStrings

 *
con

+ .
;

. /
public 
ClienteData 
( 
IOptions #
<# $
ConnectionStrings$ 5
>5 6
options7 >
)> ?
{ 	
con 
= 
options 
. 
Value 
;  
} 	
public 
async 
Task 
< 
List 
< 
Cliente &
>& '
>' (
Lista) .
(. /
)/ 0
{ 	
List 
< 
Cliente 
> 
lista 
=  !
new" %
List& *
<* +
Cliente+ 2
>2 3
(3 4
)4 5
;5 6
using 
( 
var 
conexion 
=  !
new" %
SqlConnection& 3
(3 4
con4 7
.7 8
	CadenaSQL8 A
)A B
)B C
{ 
await 
conexion 
. 
	OpenAsync (
(( )
)) *
;* +

SqlCommand 
cmd 
=  
new! $

SqlCommand% /
(/ 0
$str0 A
,A B
conexionC K
)K L
;L M
cmd 
. 
CommandType 
=  !
CommandType" -
.- .
StoredProcedure. =
;= >
using 
( 
var 
dr 
= 
await  %
cmd& )
.) *
ExecuteReaderAsync* <
(< =
)= >
)> ?
{ 
while 
( 
await  
dr! #
.# $
	ReadAsync$ -
(- .
). /
)/ 0
{ 
lista 
. 
Add !
(! "
new" %
Cliente& -
(- .
). /
{ 
	IdCliente   %
=  & '
Convert  ( /
.  / 0
ToInt32  0 7
(  7 8
dr  8 :
[  : ;
$str  ; F
]  F G
)  G H
,  H I
NroDocumento!! (
=!!) *
dr!!+ -
[!!- .
$str!!. <
]!!< =
.!!= >
ToString!!> F
(!!F G
)!!G H
!!!H I
,!!I J
Nombre"" "
=""# $
dr""% '
[""' (
$str""( 0
]""0 1
.""1 2
ToString""2 :
("": ;
)""; <
!""< =
,""= >
Apellido## $
=##% &
dr##' )
[##) *
$str##* 4
]##4 5
.##5 6
ToString##6 >
(##> ?
)##? @
!##@ A
,##A B
Correo$$ "
=$$# $
dr$$% '
[$$' (
$str$$( 0
]$$0 1
.$$1 2
ToString$$2 :
($$: ;
)$$; <
!$$< =
,$$= >
Telefono%% $
=%%% &
dr%%' )
[%%) *
$str%%* 4
]%%4 5
.%%5 6
ToString%%6 >
(%%> ?
)%%? @
!%%@ A
,%%A B
FechaCreacion&& )
=&&* +
dr&&, .
[&&. /
$str&&/ >
]&&> ?
.&&? @
ToString&&@ H
(&&H I
)&&I J
!&&J K
}'' 
)'' 
;'' 
}(( 
})) 
}** 
return++ 
lista++ 
;++ 
},, 	
public-- 
async-- 
Task-- 
<-- 
Cliente-- !
>--! "
Obtener--# *
(--* +
string--+ 1
NroDocumento--2 >
)--> ?
{.. 	
Cliente// 
objeto// 
=// 
new//  
Cliente//! (
(//( )
)//) *
;//* +
using11 
(11 
var11 
conexion11 
=11  !
new11" %
SqlConnection11& 3
(113 4
con114 7
.117 8
	CadenaSQL118 A
)11A B
)11B C
{22 
await33 
conexion33 
.33 
	OpenAsync33 (
(33( )
)33) *
;33* +

SqlCommand44 
cmd44 
=44  
new44! $

SqlCommand44% /
(44/ 0
$str440 C
,44C D
conexion44E M
)44M N
;44N O
cmd55 
.55 

Parameters55 
.55 
AddWithValue55 +
(55+ ,
$str55, ;
,55; <
NroDocumento55= I
)55I J
;55J K
cmd66 
.66 
CommandType66 
=66  !
CommandType66" -
.66- .
StoredProcedure66. =
;66= >
using88 
(88 
var88 
dr88 
=88 
await88  %
cmd88& )
.88) *
ExecuteReaderAsync88* <
(88< =
)88= >
)88> ?
{99 
while:: 
(:: 
await::  
dr::! #
.::# $
	ReadAsync::$ -
(::- .
)::. /
)::/ 0
{;; 
objeto<< 
=<<  
new<<! $
Cliente<<% ,
(<<, -
)<<- .
{== 
	IdCliente>> %
=>>& '
Convert>>( /
.>>/ 0
ToInt32>>0 7
(>>7 8
dr>>8 :
[>>: ;
$str>>; F
]>>F G
)>>G H
,>>H I
NroDocumento?? (
=??) *
dr??+ -
[??- .
$str??. <
]??< =
.??= >
ToString??> F
(??F G
)??G H
!??H I
,??I J
Nombre@@ "
=@@# $
dr@@% '
[@@' (
$str@@( 0
]@@0 1
.@@1 2
ToString@@2 :
(@@: ;
)@@; <
!@@< =
,@@= >
ApellidoAA $
=AA% &
drAA' )
[AA) *
$strAA* 4
]AA4 5
.AA5 6
ToStringAA6 >
(AA> ?
)AA? @
!AA@ A
,AAA B
CorreoBB "
=BB# $
drBB% '
[BB' (
$strBB( 0
]BB0 1
.BB1 2
ToStringBB2 :
(BB: ;
)BB; <
!BB< =
,BB= >
TelefonoCC $
=CC% &
drCC' )
[CC) *
$strCC* 4
]CC4 5
.CC5 6
ToStringCC6 >
(CC> ?
)CC? @
!CC@ A
,CCA B
FechaCreacionDD )
=DD* +
drDD, .
[DD. /
$strDD/ >
]DD> ?
.DD? @
ToStringDD@ H
(DDH I
)DDI J
!DDJ K
}EE 
;EE 
}FF 
}GG 
}HH 
returnII 
objetoII 
;II 
}JJ 	
publicLL 
asyncLL 
TaskLL 
<LL 
stringLL  
>LL  !
CrearLL" '
(LL' (
ClienteLL( /
objetoLL0 6
)LL6 7
{MM 	
stringOO 
	respuestaOO 
=OO 
$strOO !
;OO! "
usingPP 
(PP 
varPP 
conexionPP 
=PP  !
newPP" %
SqlConnectionPP& 3
(PP3 4
conPP4 7
.PP7 8
	CadenaSQLPP8 A
)PPA B
)PPB C
{QQ 
awaitRR 
conexionRR 
.RR 
	OpenAsyncRR (
(RR( )
)RR) *
;RR* +

SqlCommandSS 
cmdSS 
=SS  
newSS! $

SqlCommandSS% /
(SS/ 0
$strSS0 A
,SSA B
conexionSSC K
)SSK L
;SSL M
cmdTT 
.TT 

ParametersTT 
.TT 
AddWithValueTT +
(TT+ ,
$strTT, ;
,TT; <
objetoTT= C
.TTC D
NroDocumentoTTD P
)TTP Q
;TTQ R
cmdUU 
.UU 

ParametersUU 
.UU 
AddWithValueUU +
(UU+ ,
$strUU, 5
,UU5 6
objetoUU7 =
.UU= >
NombreUU> D
)UUD E
;UUE F
cmdVV 
.VV 

ParametersVV 
.VV 
AddWithValueVV +
(VV+ ,
$strVV, 7
,VV7 8
objetoVV9 ?
.VV? @
ApellidoVV@ H
)VVH I
;VVI J
cmdWW 
.WW 

ParametersWW 
.WW 
AddWithValueWW +
(WW+ ,
$strWW, 5
,WW5 6
objetoWW7 =
.WW= >
CorreoWW> D
)WWD E
;WWE F
cmdXX 
.XX 

ParametersXX 
.XX 
AddWithValueXX +
(XX+ ,
$strXX, 7
,XX7 8
objetoXX9 ?
.XX? @
TelefonoXX@ H
)XXH I
;XXI J
cmdYY 
.YY 

ParametersYY 
.YY 
AddYY "
(YY" #
$strYY# .
,YY. /
	SqlDbTypeYY0 9
.YY9 :
VarCharYY: A
,YYA B
$numYYC F
)YYF G
.YYG H
	DirectionYYH Q
=YYR S
ParameterDirectionYYT f
.YYf g
OutputYYg m
;YYm n
cmdZZ 
.ZZ 
CommandTypeZZ 
=ZZ  !
CommandTypeZZ" -
.ZZ- .
StoredProcedureZZ. =
;ZZ= >
try\\ 
{]] 
await^^ 
cmd^^ 
.^^  
ExecuteNonQueryAsync^^ 2
(^^2 3
)^^3 4
;^^4 5
	respuesta__ 
=__ 
Convert__  '
.__' (
ToString__( 0
(__0 1
cmd__1 4
.__4 5

Parameters__5 ?
[__? @
$str__@ K
]__K L
.__L M
Value__M R
)__R S
!__S T
;__T U
}`` 
catchaa 
{bb 
	respuestacc 
=cc 
$strcc  3
;cc3 4
}dd 
}ee 
returnff 
	respuestaff 
;ff 
}gg 	
publicii 
asyncii 
Taskii 
<ii 
stringii  
>ii  !
Editarii" (
(ii( )
Clienteii) 0
objetoii1 7
)ii7 8
{jj 	
stringll 
	respuestall 
=ll 
$strll !
;ll! "
usingmm 
(mm 
varmm 
conexionmm 
=mm  !
newmm" %
SqlConnectionmm& 3
(mm3 4
conmm4 7
.mm7 8
	CadenaSQLmm8 A
)mmA B
)mmB C
{nn 
awaitoo 
conexionoo 
.oo 
	OpenAsyncoo (
(oo( )
)oo) *
;oo* +

SqlCommandpp 
cmdpp 
=pp  
newpp! $

SqlCommandpp% /
(pp/ 0
$strpp0 B
,ppB C
conexionppD L
)ppL M
;ppM N
cmdqq 
.qq 

Parametersqq 
.qq 
AddWithValueqq +
(qq+ ,
$strqq, 8
,qq8 9
objetoqq: @
.qq@ A
	IdClienteqqA J
)qqJ K
;qqK L
cmdrr 
.rr 

Parametersrr 
.rr 
AddWithValuerr +
(rr+ ,
$strrr, ;
,rr; <
objetorr= C
.rrC D
NroDocumentorrD P
)rrP Q
;rrQ R
cmdss 
.ss 

Parametersss 
.ss 
AddWithValuess +
(ss+ ,
$strss, 5
,ss5 6
objetoss7 =
.ss= >
Nombress> D
)ssD E
;ssE F
cmdtt 
.tt 

Parameterstt 
.tt 
AddWithValuett +
(tt+ ,
$strtt, 7
,tt7 8
objetott9 ?
.tt? @
Apellidott@ H
)ttH I
;ttI J
cmduu 
.uu 

Parametersuu 
.uu 
AddWithValueuu +
(uu+ ,
$struu, 5
,uu5 6
objetouu7 =
.uu= >
Correouu> D
)uuD E
;uuE F
cmdvv 
.vv 

Parametersvv 
.vv 
AddWithValuevv +
(vv+ ,
$strvv, 7
,vv7 8
objetovv9 ?
.vv? @
Telefonovv@ H
)vvH I
;vvI J
cmdww 
.ww 

Parametersww 
.ww 
Addww "
(ww" #
$strww# .
,ww. /
	SqlDbTypeww0 9
.ww9 :
VarCharww: A
,wwA B
$numwwC F
)wwF G
.wwG H
	DirectionwwH Q
=wwR S
ParameterDirectionwwT f
.wwf g
Outputwwg m
;wwm n
cmdxx 
.xx 
CommandTypexx 
=xx  !
CommandTypexx" -
.xx- .
StoredProcedurexx. =
;xx= >
tryzz 
{{{ 
await|| 
cmd|| 
.||  
ExecuteNonQueryAsync|| 2
(||2 3
)||3 4
;||4 5
	respuesta}} 
=}} 
Convert}}  '
.}}' (
ToString}}( 0
(}}0 1
cmd}}1 4
.}}4 5

Parameters}}5 ?
[}}? @
$str}}@ K
]}}K L
.}}L M
Value}}M R
)}}R S
!}}S T
;}}T U
}~~ 
catch 
{
ÄÄ 
	respuesta
ÅÅ 
=
ÅÅ 
$str
ÅÅ  3
;
ÅÅ3 4
}
ÇÇ 
}
ÉÉ 
return
ÑÑ 
	respuesta
ÑÑ 
;
ÑÑ 
}
ÖÖ 	
public
áá 
async
áá 
Task
áá 
<
áá 
string
áá  
>
áá  !
Eliminar
áá" *
(
áá* +
int
áá+ .
Id
áá/ 1
)
áá1 2
{
àà 	
string
ää 
	respuesta
ää 
=
ää 
$str
ää !
;
ää! "
using
ãã 
(
ãã 
var
ãã 
conexion
ãã 
=
ãã  !
new
ãã" %
SqlConnection
ãã& 3
(
ãã3 4
con
ãã4 7
.
ãã7 8
	CadenaSQL
ãã8 A
)
ããA B
)
ããB C
{
åå 
await
çç 
conexion
çç 
.
çç 
	OpenAsync
çç (
(
çç( )
)
çç) *
;
çç* +

SqlCommand
éé 
cmd
éé 
=
éé  
new
éé! $

SqlCommand
éé% /
(
éé/ 0
$str
éé0 D
,
ééD E
conexion
ééF N
)
ééN O
;
ééO P
cmd
èè 
.
èè 

Parameters
èè 
.
èè 
AddWithValue
èè +
(
èè+ ,
$str
èè, 8
,
èè8 9
Id
èè: <
)
èè< =
;
èè= >
cmd
êê 
.
êê 

Parameters
êê 
.
êê 
Add
êê "
(
êê" #
$str
êê# .
,
êê. /
	SqlDbType
êê0 9
.
êê9 :
VarChar
êê: A
,
êêA B
$num
êêC F
)
êêF G
.
êêG H
	Direction
êêH Q
=
êêR S 
ParameterDirection
êêT f
.
êêf g
Output
êêg m
;
êêm n
cmd
ëë 
.
ëë 
CommandType
ëë 
=
ëë  !
CommandType
ëë" -
.
ëë- .
StoredProcedure
ëë. =
;
ëë= >
try
ìì 
{
îî 
await
ïï 
cmd
ïï 
.
ïï "
ExecuteNonQueryAsync
ïï 2
(
ïï2 3
)
ïï3 4
;
ïï4 5
	respuesta
ññ 
=
ññ 
Convert
ññ  '
.
ññ' (
ToString
ññ( 0
(
ññ0 1
cmd
ññ1 4
.
ññ4 5

Parameters
ññ5 ?
[
ññ? @
$str
ññ@ K
]
ññK L
.
ññL M
Value
ññM R
)
ññR S
!
ññS T
;
ññT U
}
óó 
catch
òò 
{
ôô 
	respuesta
öö 
=
öö 
$str
öö  3
;
öö3 4
}
õõ 
}
úú 
return
ùù 
	respuesta
ùù 
;
ùù 
}
ûû 	
}
üü 
}†† 